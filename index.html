<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>KPI Görüntüleme</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    #data { width: 100%; height: 100vh; border: none; }
  </style>
</head>
<body>
  <iframe id="data"></iframe>

  <script>
    const XML_URL = "http://192.168.42.34:2700/drk15/BIOnlineKPI/11";
    const USER = "admin";
    const PASS = "salla";

    async function loadHTML() {
      try {
        const auth = 'Basic ' + btoa(`${USER}:${PASS}`);
        const res = await fetch(XML_URL + "?t=" + Date.now(), {
          headers: { "Authorization": auth },
          cache: "no-store"
        });
        if (!res.ok) throw new Error("HTTP " + res.status);

        const text = await res.text();
        // İçeriği iframe içine yaz
        const iframe = document.getElementById("data");
        const doc = iframe.contentDocument || iframe.contentWindow.document;
        doc.open();
        doc.write(text);
        doc.close();
      } catch (e) {
        document.body.innerHTML = "<p style='color:red'>İçerik alınamadı: " + e + "</p>";
      }
    }

    loadHTML();
    setInterval(loadHTML, 5000);
  </script>
</body>
</html>
